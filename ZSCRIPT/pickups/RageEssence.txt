Class RageEssence : CustomInventory
{
	default
	{
		Inventory.amount 10;
		Inventory.MaxAmount 1;
		Inventory.PickupMessage "Absorbed some Essence of Rage";
		speed 5;
		+NoBlockmap;
	}
	
	override bool TryPickup(Actor toucher)
	{
		let gardie = Gardevoir(Players[consoleplayer].mo);
		int rage = Gardevoir(players[consoleplayer].mo).GetRageValue();
		if (rage <= gardie.rageconstant) {
			gardie.addAnger(self.amount);
			GoAwayAndDie();
			return true;
		}
		
		return false;
	}
	
	States {
		Spawn :
			WILL A 4 NoDelay A_SetTics(random(1, 16));
		Spawn.Loop :
			WILL BCDA 4 Bright A_MoveCloser();
			loop;
	}
	
	action void A_MoveCloser()
	{
		int rage = Gardevoir(players[consoleplayer].mo).GetRageValue();
		if (rage >= Gardevoir(players[consoleplayer].mo).rageconstant) self.bSpecial = false;
		else {
			self.bSpecial = true;
			target = players[consoleplayer].mo;
			if (Distance2D(players[consoleplayer].mo) <= 128) {
				A_FaceTarget();
				A_Weave(5, 5, 5, 5);
				Thrust();
			}
		}
	}
}
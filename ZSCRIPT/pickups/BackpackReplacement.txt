Class GHAGBackpack : Backpack replaces Backpack
{
	override bool HandlePickup (Inventory item)
	{
		if (item is 'BackpackItem')
		{
			for (let probe = Owner.Inv; probe != NULL; probe = probe.Inv)
			{
				let ammoitem = Ammo(probe);

				if (ammoitem && ammoitem.GetParentAmmo() == ammoitem.GetClass())
				{
					if (ammoItem.maxAmount <= ammoItem.BackpackMaxAmount * 20) {
						ammoItem.MaxAmount = ammoitem.MaxAmount * 1.5;
						if (ammoItem.MaxAmount >= (ammoItem.BackpackMaxAmount * 20)) ammoItem.MaxAmount = ammoItem.BackpackMaxAmount * 20;
						if (ammoitem.Amount < ammoitem.MaxAmount || sv_unlimited_pickup)
						{
							int amount = ammoitem.Default.BackpackAmount;
							if (!bIgnoreSkill)
							{
								amount = int(amount * G_SkillPropertyFloat(SKILLP_AmmoFactor));
							}
							ammoitem.Amount += amount;
							if (ammoitem.Amount > ammoitem.MaxAmount && !sv_unlimited_pickup)
							{
								ammoitem.Amount = ammoitem.MaxAmount;
							}
						}
					}
				}
			}
			
			int rng = random(1, 100);
			if (rng <= 25) 
			{
				players[consoleplayer].mo.A_Dropitem("GHAGPistolOverlay", 1);
			} else if (rng >= 95) {
				players[consoleplayer].mo.A_Dropitem("GHAGShotgunOverlay", 1);
			}
			
			item.bPickupGood = true;
			return true;
		}
		return false;
	}
}
Class SecretBonus : RandomSpawner
{
	default
	{
		DropItem "RageCandyBar", 255, 100;
		DropItem "ExtraShotgun", 255, 10;
		DropItem "ExtraPistol", 255, 10;
		DropItem "ReviveHalf", 255, 5;
	}	
}

Class ReviveHalf : Inventory
{
	default
	{
		XScale 0.15;
		YScale 0.15;
		+Floatbob;
		Inventory.PickupMessage "Found a Revive!";
		Inventory.MaxAmount 10;
		Inventory.pickupSound "pickups/item";
	}
	states
	{
		Spawn:
			HREV A 1;
			Loop;
	}
}

Class ExtraShotgun : CustomInventory
{
	default
	{
		+Floatbob;
		Inventory.PickupMessage "Found an extra shotgun!";
	}
	States
	{
		Spawn :
			SHOT A 1 Bright
			{
				let player = Gardevoir(players[consoleplayer].mo);
				if (player.countinv("GHAGShotgunOverlay") == 4)
				{
					invoker.spawn("RageCandyBar", invoker.pos);
					invoker.destroy();
				}
			}
			Loop;
		Pickup :
			TNT1 A 0
			{
				let player = Gardevoir(players[consoleplayer].mo);
				player.giveInventory("GHAGShotgunOverlay", 1);
			}
			stop;
	}
}

Class ExtraPistol : CustomInventory
{
	default
	{
		+Floatbob;
		Inventory.PickupMessage "Found an extra pistol!";
	}
	States
	{
		Spawn :
			PIST C 1 Bright
			{
				let player = Gardevoir(players[consoleplayer].mo);
				if (player.countinv("GHAGPistolOverlay") == 4)
				{
					invoker.spawn("RageCandyBar", invoker.pos);
					invoker.destroy();
				}
			}
			Loop;
		Pickup :
			TNT1 A 0
			{
				let player = Gardevoir(players[consoleplayer].mo);
				player.giveInventory("GHAGPistolOverlay", 1);
			}
			stop;
	}
}

Class RageCandyBar : CustomInventory
{
	default
	{
		XScale 0.15;
		YScale 0.15;
		+Floatbob;
		Inventory.PickupMessage "Ate a Rage Candy Bar! Max anger raised!";
	}

	states
	{
		Spawn:
			RAGE A 1;
			Loop;
		Pickup:
			TNT1 A 0
			{
				A_StartSound("pickups/item");
				if (Gardevoir(players[consoleplayer].mo).RageConstant < 1000)
				{
					Gardevoir(players[consoleplayer].mo).IncreaseAngerRange(20);
				} 
				else 
				{
					Gardevoir(players[consoleplayer].mo).IncreaseAngerRange(10);
				}
			}
			stop;
	}
}